"use strict";(self.webpackChunkxcrossinglines=self.webpackChunkxcrossinglines||[]).push([[318],{2318:(e,t,s)=>{s.r(t),s.d(t,{default:()=>B});var r=s(2791),n=s(3360),a=s(7022),o=s(2144),c=s(7689),l=s(6122),i=s(4715),d=s(6342),x=s(2797),u=s(5794),h=s(9554),m=s(9625),j=s(3853),p=s(6355),b=s(7612),f=s(9920),y=s(7644),g=s(5977),w=s(2879),v=s(6612),N=s(184);function Z(){const e=r.useContext(d.Vz),t=r.useRef(),[s,a]=r.useState(0),[o,c]=r.useState(!1),[l,i]=r.useState(u.tx.none),[m,j]=r.useState(""),[p,Z]=r.useState(""),k=(e,t,s)=>{i((t=>e)),j((e=>t)),Z((e=>s)),c((t=>e===u.tx.loading||e===u.tx.success))},_=r.useCallback((async e=>{var s;null===(s=t.current)||void 0===s||s.scrollIntoView({block:"nearest"}),k(u.tx.loading,"Loading ...","");const r="quote/job/api/get/".concat(e,"/");await h.Z.get(r).then((e=>{k(u.tx.none,"",""),200===e.status&&z(e.data)})).catch((e=>(0,w.X)(e,k)))}),[]),C=e=>u.Ht.findIndex((t=>t.size===e.size)),S=(e,t)=>u.Ht[e].size===t.size,z=e=>{const t=u.Ht.findIndex((t=>{const s=Number(e.vehicle_size).toFixed(1);return Number("".concat(t.size)).toFixed(1)===s}));a((e=>t))};return r.useEffect((()=>{_(e.primaryKey)}),[e.show]),(0,N.jsxs)(b.Z,{centered:!0,show:e.show,contentClassName:"rounded-0",onHide:o?null:()=>{k(u.tx.none,"",""),e.setShow((e=>!1))},children:[(0,N.jsx)(b.Z.Header,{ref:t,closeButton:!0,className:"rounded-0 text-dark border-0",children:(0,N.jsx)(b.Z.Title,{style:{fontWeight:"900"},children:"Edit vehicle size"})}),(0,N.jsxs)(b.Z.Body,{children:[(0,x.w)(l,m,p),(0,N.jsx)(f.Z,{activeIndex:s,controls:!1,indicators:!1,children:u.Ht.map(((e,t)=>(0,N.jsx)(f.Z.Item,{className:"px-4 pt-2",children:(0,N.jsx)("div",{className:"w-100 d-flex justify-content-center align-items-center",children:(0,N.jsx)("img",{className:"d-block w-75",src:e.img,alt:"".concat(e.size)})})},t)))}),(0,N.jsx)("div",{className:"py-3 d-flex flex-column justify-content-start align-items-start gap-2",children:u.Ht.map(((e,t)=>(0,N.jsx)(v.w,{className:"p-1",children:(0,N.jsx)(y.Z.Group,{children:(0,N.jsxs)(y.Z.Check,{type:"checkbox",disabled:o,value:e.size,checked:S(s,e),onClick:t=>a((t=>C(e))),children:[(0,N.jsxs)(y.Z.Check.Label,{style:{fontSize:"".concat(.875,"rem"),fontWeight:S(s,e)?600:""},onClick:t=>a((t=>C(e))),children:[(0,N.jsxs)("span",{className:"text-".concat(S(s,e)?"primary":"dark"),style:{fontWeight:"900"},children:[e.size," Ton"]})," ",e.description]}),(0,N.jsx)(y.Z.Check.Input,{type:"checkbox",value:e.size,disabled:o,onChange:e=>{},onClick:t=>a((t=>C(e))),checked:S(s,e)})]})})},t)))})]}),(0,N.jsx)(b.Z.Footer,{className:"rounded-0 border-0",children:(0,N.jsx)(n.Z,{variant:"outline-primary",className:"border-0 rounded-0 fw-bold",disabled:o,onClick:async()=>await(async s=>{var r;null===(r=t.current)||void 0===r||r.scrollIntoView({block:"nearest"}),k(u.tx.loading,"Updating ...","");const n="quote/job/api/update/".concat(e.primaryKey,"/");await h.Z.put(n,{vehicle_size:s}).then((async t=>{200===t.status&&(k(u.tx.success,"Awesome.","Updated"),await(0,g.r)((()=>e.setShow((e=>!1))),2e3),await(0,g.r)((()=>window.location.href="/jobs/job/".concat(e.primaryKey,"/create"))))})).catch((e=>(0,w.X)(e,k)))})(u.Ht[s].size.toFixed(1)),children:"Select & update"})})]})}var k=s(9561),_=s(9513),C=s.n(_);s(8077);function S(){const e=r.useContext(d.Vz),t=r.useRef(),s=r.useRef(),[a,o]=r.useState(new Date),[c,l]=r.useState(1),[i,m]=r.useState(0),[j,p]=r.useState(0),[f,v]=r.useState(!1),[Z,_]=r.useState("CASH"),[S,z]=r.useState(""),[I,H]=r.useState(!1),[P,F]=r.useState(u.tx.none),[q,D]=r.useState(""),[T,A]=r.useState(""),[R,B]=r.useState("border-0 text-dark"),L=Array(3).fill(0),O=Array(11).fill(0),V=(e,t,s)=>{F((t=>e)),D((e=>t)),A((e=>s));const r=e===u.tx.loading||e===u.tx.success;H((e=>r))},E=(e,t,s)=>e>1?"".concat(e," ").concat(s):"".concat(e," ").concat(t),J=async r=>{var n;null===(n=s.current)||void 0===n||n.scrollIntoView({block:"nearest"});if(r-Date.now()<54e5)return B((e=>"border border-danger border-1 text-danger")),void V(u.tx.error,"Oops! error. ","".concat(u.WD));V(u.tx.none,"",""),B((e=>"border-0 text-dark"));const o=a.getFullYear(),l=a.getMonth()+1,d=a.getDate(),x=a.getHours(),m=a.getMinutes(),p=a.getSeconds(),b="".concat(o,"-").concat(l,"-").concat(d),f="".concat(x,":").concat(m,":").concat(p);await(async t=>{var r;null===(r=s.current)||void 0===r||r.scrollIntoView({block:"nearest"}),V(u.tx.loading,"Updating ...","");const n="quote/job/api/update/".concat(e.primaryKey,"/");await h.Z.put(n,t).then((async t=>{200===t.status&&(V(u.tx.success,"Awesome.","Updated"),await(0,g.r)((()=>e.setShow((e=>!1))),2e3),await(0,g.r)((()=>window.location.href="/jobs/job/".concat(e.primaryKey,"/create"))))})).catch((e=>(0,w.X)(e,V)))})({job_date:b,job_time:f,helpers:c,shuttle:j,floors:i,payment_option:Z,driver_note:t.current.value})},U=async e=>{var r;null===(r=s.current)||void 0===r||r.scrollIntoView({block:"nearest"}),V(u.tx.loading,"Loading ...","");const n="quote/job/api/get/".concat(e,"/");await h.Z.get(n).then((e=>{if(V(u.tx.none,"",""),200===e.status){const s=new Date("".concat(e.data.job_date," ").concat(e.data.job_time));t.current.value=e.data.driver_note,l((t=>e.data.helpers)),m((t=>e.data.floors)),((e,t)=>{if(e<=u.Ht[1].size)return v((e=>!0)),void p((e=>0));v((e=>!1)),p((e=>t))})(e.data.vehicle_size,e.data.shuttle),_((t=>e.data.payment_option)),o((e=>s))}})).catch((e=>(0,w.X)(e,V)))};return(0,N.jsxs)(b.Z,{centered:!0,show:e.show,contentClassName:"rounded-0",onHide:I?null:()=>{B((e=>"border-0 text-dark")),V(u.tx.none,"",""),e.setShow((e=>!1))},onEntered:()=>U(e.primaryKey),children:[(0,N.jsx)(b.Z.Header,{ref:s,closeButton:!0,className:"rounded-0 text-dark border-0",children:(0,N.jsx)(b.Z.Title,{style:{fontWeight:"900"},children:"Edit additional information"})}),(0,N.jsxs)(b.Z.Body,{children:[(0,x.w)(P,q,T),(0,N.jsxs)(y.Z.Group,{className:"position-relative mb-3 mt-".concat(P===u.tx.none?"0":"3"),children:[(0,N.jsx)(C(),{disabled:I,startDate:a,minDate:Date.now(),showTimeSelect:!0,showPopperArrow:!1,className:"form-control py-1 w-auto rounded-0 bg-white border-0 fw-bold text-start border-primary date__time",dateFormat:"yyyy-MMM-dd HH:mm",timeFormat:"HH:mm",calendarClassName:"rounded-0 w-100 d-flex flex-row",selected:a,onFocus:e=>e.target.readOnly=!0,onChange:e=>{o((t=>e))}}),(0,N.jsx)("div",{className:"text-start ps-3",children:(0,N.jsx)(y.Z.Text,{children:"Job date and time"})})]}),(0,N.jsxs)(y.Z.Group,{className:"mb-3",children:[(0,N.jsxs)(k.Z,{className:"border-0",children:[(0,N.jsxs)(k.Z.Toggle,{disabled:I,variant:"outline-light",className:"py-1 rounded-0 border-0 text-dark fw-bold d-flex justify-content-between align-items-center",children:["Additional helpers : ",c]}),(0,N.jsx)(k.Z.Menu,{className:"rounded-0",children:L.map(((e,t)=>(0,N.jsx)(k.Z.Item,{className:"fw-bold",id:L.length-t,onClick:e=>l((t=>Number(e.currentTarget.id))),children:E(L.length-t,"Helper","Helpers")},t+1)))})]}),(0,N.jsx)("div",{className:"text-start ps-3",children:(0,N.jsxs)(y.Z.Text,{children:["Driver + ",E(c,"helper","helpers")]})})]}),(0,N.jsxs)(y.Z.Group,{className:"mb-3",children:[(0,N.jsxs)(k.Z,{className:"border-0",children:[(0,N.jsxs)(k.Z.Toggle,{disabled:I,variant:"outline-light",className:"py-1 rounded-0 border-0 text-dark fw-bold d-flex justify-content-between align-items-center",children:["Floors to carry : ",i]}),(0,N.jsx)(k.Z.Menu,{className:"rounded-0",children:O.map(((e,t)=>(0,N.jsx)(k.Z.Item,{className:"fw-bold",id:O.length-1-t,onClick:e=>m((t=>Number(e.currentTarget.id))),children:E(O.length-1-t,"Floor","Floors")},t)))})]}),(0,N.jsx)("div",{className:"text-start ps-3",children:(0,N.jsx)(y.Z.Text,{children:"No. of floors to carry from and to pickup routes."})})]}),(0,N.jsxs)(y.Z.Group,{className:"mb-3",children:[(0,N.jsxs)(k.Z,{className:"border-0",children:[(0,N.jsxs)(k.Z.Toggle,{disabled:I,variant:"outline-light",className:"py-1 rounded-0 border-0 text-dark fw-bold d-flex justify-content-between align-items-center",children:["Payment method: ","".concat(Z).toLowerCase()]}),(0,N.jsx)(k.Z.Menu,{className:"rounded-0",children:["Cash","Eft"].map(((e,t)=>(0,N.jsx)(k.Z.Item,{id:e,className:"fw-bold",onClick:t=>_((t=>"".concat(e).toUpperCase())),children:e},t)))})]}),(0,N.jsx)("div",{className:"text-start ps-3",children:(0,N.jsxs)(y.Z.Text,{children:[(0,N.jsx)("span",{className:"text-danger fw-bold",children:"Please note! "})," pay"," ","".concat(Z).toLowerCase()," at delivery point."]})})]}),(0,N.jsxs)(y.Z.Group,{className:"px-3",children:[(0,N.jsx)(y.Z.Label,{children:"Driver note"}),(0,N.jsx)(y.Z.Control,{disabled:I,required:!1,ref:t,className:"w-100 h-50 rounded-0 fw-bold",placeholder:"".concat(S)}),(0,N.jsx)(y.Z.Text,{children:"Leave a note for the driver, this can be any information you'd like to convey or any special requests."})]})]}),(0,N.jsx)(b.Z.Footer,{className:"rounded-0 border-0",children:(0,N.jsx)(n.Z,{disabled:I,variant:"outline-primary",className:"rounded-0 border-0 fw-bold",onClick:async()=>await J(a),children:"Select & update"})})]})}s(3922),s(473);var z=s(9410),I=s(4017),H=s(8617),P=(s(1578),s(6856));function F(){const e=r.useRef(),t=r.useContext(d.Vz),s=r.useRef(),[a,o]=r.useState([]),[c,l]=r.useState(!1),[i,m]=r.useState(u.tx.none),[j,p]=r.useState(""),[f,v]=r.useState(""),{placesService:Z,placePredictions:k,getPlacePredictions:_,isPlacePredictionsLoading:C}=(0,I.Z)({apiKey:u.JO,debounce:100,options:{componentRestrictions:{country:"za"}}}),S=(e,t,s)=>{m((t=>e)),p((e=>t)),v((e=>s));const r=e===u.tx.loading||e===u.tx.success;l((e=>r))},F=(e,t)=>t<=0?"Pickup":t>0&&t<e.length-1?"Pickup|Dropoff":"Dropoff",q=async e=>{var r;null===(r=s.current)||void 0===r||r.scrollIntoView({block:"nearest"}),S(u.tx.loading,"Loading ...","");await h.Z.post("jobs/api/compute-distance/",{routes:e}).then((async r=>{200===r.status&&(async e=>{var r;null===(r=s.current)||void 0===r||r.scrollIntoView({block:"nearest"}),S(u.tx.loading,"Updating ...","");const n="quote/job/api/update/".concat(t.primaryKey,"/");await h.Z.put(n,e).then((async e=>{200===e.status&&(S(u.tx.success,"Awesome.","Updated"),await(0,g.r)((()=>t.setShow((e=>!1))),2e3),await(0,g.r)((()=>window.location.href="/jobs/job/".concat(t.primaryKey,"/create"))))})).catch((e=>(0,w.X)(e,S)))})({routes:e,distance:r.data.distance})})).catch((e=>(0,w.X)(e,S)))},D=e=>{let{routes:t}=e;return(0,N.jsx)("div",{className:"mt-3",children:(0,N.jsxs)("table",{className:"table table-bordered table-striped table-dark m-0",children:[t.length>0?(0,N.jsx)("thead",{children:(0,N.jsx)("tr",{children:(0,N.jsx)("th",{children:"Routes"})})}):null,(0,N.jsx)("tbody",{children:t.map(((e,s)=>(0,N.jsx)("tr",{children:(0,N.jsx)("td",{children:(0,N.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center",children:[(0,N.jsxs)("div",{className:"d-flex flex-column",children:[(0,N.jsxs)("span",{className:"form-text fw-bold text-warning",children:[s+1," - ",F(t,s)]}),(0,N.jsx)("span",{style:{fontSize:"".concat(.875,"rem")},children:e.route_name})]}),(0,N.jsx)("div",{className:"ms-2",children:(0,N.jsx)("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:c?null:()=>{const t=a.filter((function(t){return t!==e}));o((e=>[...t]))}})})]})})},"route-".concat(s))))})]})})},T=t=>{if(t.length>0)return t.map(((t,s)=>(0,N.jsxs)("li",{className:"btn btn-light border-0 w-100 rounded-0 text-dark d-flex flex-row justify-content-start align-items-start text-start gap-2",onClick:()=>{return s=t,void(null===Z||void 0===Z||Z.getDetails({placeId:s.place_id},(t=>{const r={route_name:"".concat(s.structured_formatting.main_text," ").concat(s.structured_formatting.secondary_text),lat:t.geometry.location.lat(),lng:t.geometry.location.lng()};o((e=>[...a,r])),_({input:""}),e.current.value=""})));var s},children:[(0,N.jsx)("div",{className:"p-0 m-0",children:(0,N.jsx)(H.XAC,{color:"red"})}),(0,N.jsxs)("span",{style:{fontSize:"".concat(.875,"rem")},children:[(0,N.jsx)("strong",{children:t.structured_formatting.main_text})," ",t.structured_formatting.secondary_text]})]},s)))},A=r.useCallback((async e=>{var t;null===(t=s.current)||void 0===t||t.scrollIntoView({block:"nearest"}),S(u.tx.loading,"Loading ...","");const r="quote/job/api/get/".concat(e,"/");await h.Z.get(r).then((e=>{S(u.tx.none,"",""),200===e.status&&o((()=>[...e.data.routes]))})).catch((e=>(0,w.X)(e,S)))}),[]);return r.useEffect((()=>{A(t.primaryKey)}),[t.show]),(0,N.jsxs)(b.Z,{contentClassName:"rounded-0",centered:!0,show:t.show,onHide:c?null:()=>{S(u.tx.none,"",""),t.setShow((e=>!1))},children:[(0,N.jsx)(b.Z.Header,{ref:s,closeButton:!0,className:"rounded-0 text-dark border-0",children:(0,N.jsx)(b.Z.Title,{style:{fontWeight:"900"},children:"Edit routes"})}),(0,N.jsxs)(b.Z.Body,{children:[(0,x.w)(i,j,f),(0,N.jsx)(D,{routes:a}),(0,N.jsxs)(y.Z.Group,{className:"position-relative mt-3",children:[(0,N.jsxs)(z.Z,{children:[(0,N.jsx)(y.Z.Control,{className:"fw-bold rounded-0 border-end-0",placeholder:"Search",ref:e,disabled:c,onChange:e=>_({input:e.target.value})}),(0,N.jsx)(z.Z.Text,{className:"bg-white rounded-0",children:(0,N.jsx)(P.yw4,{color:"red"})})]}),(0,N.jsx)("ul",{className:"dropdown__shadow mt-2 p-0 shadow-sm w-100 position-absolute bg-white d-flex flex-column justify-content-center align-items-center gap-1",style:{listStyle:"none",zIndex:"999"},children:(R=C,R?(0,N.jsx)("div",{className:"w-100 p-2 d-flex flex-row justify-content-center align-items-center",children:(0,N.jsx)("div",{className:"spinner-border text-secondary",role:"status",children:(0,N.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):k.length>0?T(k):void 0)})]})]}),(0,N.jsx)(b.Z.Footer,{className:"rounded-0 border-0",children:(0,N.jsx)(n.Z,{variant:"outline-primary",className:"border-0 rounded-0 fw-bold",onClick:async()=>await q(a),disabled:c,children:"Select & update"})})]});var R}var q=s(3978),D=s(9775),T=s(5594),A=s(4674),R=s(8808);function B(){const{pk:e}=(0,c.UO)(),t=(0,c.s0)(),[s,b]=r.useState({return_customer_discount:0,hear_about_us:"Referral"}),[f,y]=r.useState(!1),[k,_]=r.useState(!1),[C,z]=r.useState(!1),[I,H]=r.useState(!1),[P,B]=r.useState(u.tx.none),[L,O]=r.useState(""),[V,E]=r.useState(""),[J,U]=r.useState(!1),K=(e,t,s)=>{B((t=>e)),O((e=>t)),E((e=>s));const r=e===u.tx.loading||e===u.tx.info||e===u.tx.success;U((e=>r))},X=e=>{let{vJob:t}=e;return(0,N.jsxs)("div",{className:"mx-3 my-2",children:[(0,N.jsxs)("table",{className:"table table-secondary table-striped table-bordered m-0",children:[(0,N.jsx)("thead",{children:(0,N.jsx)("tr",{children:(0,N.jsx)("th",{scope:"col",children:"Routes"})})}),(0,N.jsx)("tbody",{children:t.routes.map(((e,t)=>(0,N.jsx)("tr",{children:(0,N.jsx)("td",{children:(0,N.jsxs)("div",{className:"d-flex flex-column",children:[(0,N.jsxs)("span",{className:"form-text fw-bold",children:[t+1," - ",u.tP[e.description]]}),(0,N.jsx)("span",{children:e.route_name})]})})},t)))})]}),(0,N.jsxs)("table",{className:"table table-striped table-bordered table-secondary m-0 mt-2",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{scope:"col",children:"Description"}),(0,N.jsx)("th",{scope:"col",children:"Qty"})]})}),(0,N.jsx)("tbody",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Distance"}),(0,N.jsx)("td",{children:"".concat(s.distance," km")})]})})]})]})},M=e=>{let{vJob:t}=e;if(t.job_date&&t.job_time)return(0,N.jsxs)(r.Fragment,{children:[(0,N.jsx)("div",{className:"pt-2"}),(0,N.jsx)("div",{className:"px-3 pt-2 pb-2",children:(0,N.jsxs)("table",{className:"table table-striped table-bordered table-secondary m-0",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{scope:"col",children:"Description"}),(0,N.jsx)("th",{scope:"col",children:"Qty"})]})}),(0,N.jsxs)("tbody",{children:[(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Job date"}),(0,N.jsx)("td",{children:A.Ib.format(new Date("".concat(t.job_date)))})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Job time"}),(0,N.jsx)("td",{children:A.Lm.format(new Date("".concat(t.job_date," ").concat(t.job_time)))})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Payment option"}),(0,N.jsx)("td",{children:"".concat(s.payment_option)})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Helpers"}),(0,N.jsx)("td",{children:"".concat(s.helpers)})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Floors"}),(0,N.jsx)("td",{children:"".concat(s.floors)})]}),(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Driver note"}),(0,N.jsx)("td",{children:"".concat(s.driver_note)})]})]})]})})]})},W=e=>{let{leading:t,onClick:s,showIcon:n=!0,disableButton:a=!1}=e;return(0,N.jsx)(r.Fragment,{children:(0,N.jsx)(v.w,{onClick:a?null:()=>s((e=>!0)),children:(0,N.jsxs)("div",{className:"bg-secondary bg-opacity-75 px-3 py-2 d-flex flex-row justify-content-between align-items-start gap-1",children:[(0,N.jsx)("span",{className:"text-white",style:{fontWeight:"900",fontSize:"".concat(1.125,"rem")},children:t}),n?(0,N.jsx)("div",{children:(0,N.jsx)(j.vPQ,{color:"white"})}):null]})})})},G=e=>{let{job_quote:t,loaded:s}=e;return s?(0,N.jsxs)(r.Fragment,{children:[(0,N.jsx)(W,{leading:"Job vehicle type",onClick:H,disableButton:J}),(0,N.jsx)("div",{className:"my-2 px-3",children:(0,N.jsxs)("table",{className:"table table-striped table-bordered table-secondary m-0",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{scope:"col",children:"Description"}),(0,N.jsx)("th",{scope:"col",children:"Qty"})]})}),(0,N.jsx)("tbody",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Vehicle size"}),(0,N.jsx)("td",{children:"".concat(t.vehicle_size," Ton")})]})})]})}),(0,N.jsx)(W,{leading:"Job routes",onClick:z,disableButton:J}),(0,N.jsx)(X,{vJob:t}),(0,N.jsxs)("div",{className:"mb-3",children:[(0,N.jsx)(W,{leading:"Job add-info ",onClick:_,disableButton:J}),(0,N.jsx)(M,{vJob:t})]}),(0,N.jsx)(R.U,{job:t}),(0,N.jsx)("div",{className:"w-100 mt-3 pb-3 pe-3 d-flex flex-row justify-content-end align-items-center",children:(0,N.jsxs)(n.Z,{variant:"outline-primary",className:"fw-bold border-0 rounded-0 d-flex flex-row justify-content-center align-items-center gap-2",disabled:J,onClick:async()=>Q(t),children:["Book",(0,N.jsx)(p.l_A,{})]})})]}):(0,N.jsx)(N.Fragment,{})},Q=r.useCallback((async e=>{K(u.tx.loading,"Creating ...","");const[s,r]=(0,m.f)();if(s){const t="jobs/api/job/create/";await h.Z.post(t,e).then((async e=>{K(u.tx.success,"Awesome.","Created"),await(0,g.r)((()=>{let e=window.document.createElement("a");e.href=u.dX.jobs,e.target="_self",e.click()}),2e3)})).catch((e=>(0,w.X)(e,K)))}else{const e="To complete this job, you must be signed in. we'll navigate you to the sign-in page.";K(u.tx.info,"Dear valued customer. ",e),await(0,g.r)((()=>t(u.dX.signin)),6e3)}}),[]),$=r.useCallback((async e=>{y((e=>!1)),K(u.tx.loading,"Loading ...","");const t="quote/job/api/get/".concat(e,"/");await h.Z.get(t).then((async e=>{if(200===e.status){const t=Number(e.data.vehicle_size).toFixed(1),r={...e.data,vehicle_size:t};b((e=>({...s,...r}))),(0,i.$)(r),K(u.tx.none,"",""),y((e=>!0))}})).catch((e=>(0,w.X)(e,K)))}),[]);return r.useEffect((()=>{$(e)}),[e]),r.useEffect((()=>{window.scrollTo(0,0)}),[P]),(0,N.jsxs)(q.E.section,{className:"pb-3 px-3",variants:D.v,animate:"visible",initial:"hidden",exit:"exit",transition:{duration:T.V$,delay:T.p},children:[(0,N.jsxs)(a.Z,{className:"p-0 d-flex flex-column justify-content-center align-items-center",children:[(0,N.jsxs)(o.Z,{className:"dropdown__shadow card__section border-0 rounded-0 ",children:[(0,N.jsx)(o.Z.Header,{className:"text-white bg-secondary rounded-0 border-0 py-2",children:(0,N.jsx)("div",{className:"d-flex flex-column justify-content-center align-items-start",children:(0,N.jsx)("span",{style:{fontWeight:"900"},children:"CREATE JOB"})})}),(0,N.jsxs)(o.Z.Body,{className:"p-0",children:[(0,x.w)(P,L,V),(0,N.jsx)(G,{job_quote:s,loaded:f})]})]}),((e,t)=>{if(e)return(0,N.jsxs)(r.Fragment,{children:[(0,N.jsx)(d.Vz.Provider,{value:{primaryKey:t,show:k,setShow:_},children:(0,N.jsx)(S,{})}),(0,N.jsx)(d.Vz.Provider,{value:{primaryKey:t,show:I,setShow:H},children:(0,N.jsx)(Z,{})}),(0,N.jsx)(d.Vz.Provider,{value:{primaryKey:t,show:C,setShow:z},children:(0,N.jsx)(F,{})})]})})(f,e)]}),(0,N.jsx)(l.P,{height:"".concat(window.innerHeight/2,"px")})]})}},8808:(e,t,s)=>{s.d(t,{U:()=>d});s(2791);var r=s(9813),n=s(2144),a=s(8396),o=s(9126),c=s(5794),l=s(6612),i=s(184);function d(e){let{job:t,padding:s="p-3"}=e;const d=Intl.NumberFormat("en-ZA",{style:"currency",currency:"zar",minimumSignificantDigits:1}),x=e=>(0,i.jsx)(r.Z,{id:"popover-basic",className:"rounded-0 border-secondary",arrowProps:{style:{backgroundColor:"red"}},children:(0,i.jsx)(r.Z.Body,{className:"text-secondary fw-bold rounded-0",children:e})});return(0,i.jsx)(n.Z,{className:"dropdown__shadow rounded-0 border-0",children:(0,i.jsx)(n.Z.Body,{className:"".concat(s),children:(0,i.jsxs)("table",{className:"table table-bordered table-striped table-dark m-0",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"Description"}),(0,i.jsx)("th",{scope:"col",children:"Price(ZAR)"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[(0,i.jsx)("span",{children:"Base fee"}),(0,i.jsx)(l.w,{className:"px-1",children:(0,i.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.rF)),children:(0,i.jsx)("div",{children:(0,i.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,i.jsx)("td",{children:"".concat(d.format(t.base_fee))})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[(0,i.jsx)("span",{children:"Off peak"}),(0,i.jsx)(l.w,{className:"px-1",children:(0,i.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.Pm)),children:(0,i.jsx)("div",{children:(0,i.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,i.jsx)("td",{className:"text-danger fw-bolder",children:"".concat(t.mid_discount>0?"-":""," ").concat(d.format(t.mid_discount))})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[(0,i.jsx)("span",{children:"Return customer"}),(0,i.jsx)(l.w,{className:"px-1",children:(0,i.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.te)),children:(0,i.jsx)("div",{children:(0,i.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,i.jsx)("td",{className:"text-danger fw-bolder",children:"".concat(t.return_customer_discount>0?"-":""," ").concat(d.format(t.return_customer_discount))})]}),t.give_extra_discount?(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[(0,i.jsx)("span",{children:"Extra discount"}),(0,i.jsx)(l.w,{className:"px-1",children:(0,i.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.j_)),children:(0,i.jsx)("div",{children:(0,i.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,i.jsx)("td",{className:"text-danger",children:"".concat(t.give_extra_discount?"-":""," ").concat(d.format(t.extra_discount))})]}):null,t.set_price_adjustment?(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"d-flex flex-column",children:[(0,i.jsxs)("div",{className:"d-flex flex-row",children:[(0,i.jsx)("span",{children:"Price adjustment"}),(0,i.jsx)(l.w,{className:"px-1",children:(0,i.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.fk)),children:(0,i.jsx)("div",{children:(0,i.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]}),(0,i.jsxs)("span",{className:"text-muted form-text fw-bold border border-2 px-1 bg-light",children:["Price adjustment justification:"," ",(0,i.jsx)("span",{className:"text-dark",children:t.price_adjustment_justification})]})]})}),(0,i.jsx)("td",{children:"".concat(d.format(t.price_adjustment))})]}):null]}),(0,i.jsx)("tfoot",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[(0,i.jsx)("span",{style:{fontWeight:"900"},children:"Amount due"}),(0,i.jsx)(l.w,{className:"px-1",children:(0,i.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.Iu)),children:(0,i.jsx)("div",{children:(0,i.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{style:{fontWeight:"900",fontSize:"".concat(1.25,"rem")},children:d.format(t.amount_due).replace("ZA","")})})]})})]})})})}},6342:(e,t,s)=>{s.d(t,{IK:()=>n,Vz:()=>l,XK:()=>a,eJ:()=>c,j3:()=>o,kH:()=>i});var r=s(2791);const n=r.createContext(),a=r.createContext(),o=r.createContext(),c=r.createContext(),l=r.createContext(),i=r.createContext()},2879:(e,t,s)=>{s.d(t,{X:()=>a});const r={100:"Continue",101:"Switching protocols",102:"Processing",103:"Early hints",200:"Ok",201:"Created",202:"Accepted",203:"Non authoritative information",204:"No content",205:"Reset content",206:"Partial content",207:"Multi status",208:"Already reported",226:"Im used",300:"Multiple choices",301:"Moved permanently",302:"Found",303:"See other",304:"Not modified",305:"Use proxy",306:"Reserved",307:"Temporary redirect",308:"Permanent redirect",400:"Bad request",401:"Unauthorized",402:"Payment required",403:"Forbidden",404:"Not found",405:"Method_not_allowed",406:"Not acceptable",407:"Proxy authentication required",408:"Request timeout",409:"Conflict",410:"Gone",411:"Length required",412:"Precondition failed",413:"Request entity too large",414:"Request uri too long",415:"Unsupported media type",416:"Requested range not satisfiable",417:"Expectation failed",418:"Im a teapot",421:"Misdirected_request",422:"Unprocessable entity",423:"Locked",424:"Failed dependency",425:"Too early",426:"Upgrade required",428:"Precondition required",429:"Too many requests",431:"Request header fields too large",451:"Unavailable for legal reasons"};var n=s(5794);function a(e,t){if(e.response){let s;const a=e.response.status;if(a>=500)return s="Internal server error. Contact admin",void t(n.tx.error,"Oops!",s);e.response.data.detail?(s="".concat(r[a],", ").concat(e.response.data.detail),t(n.tx.error,"Oops!",s)):e.response.data.msg?(s="".concat(r[a],", ").concat(e.response.data.msg),t(n.tx.error,"Oops!",s)):e.response.data.email?(s="".concat(r[a],", ").concat(e.response.data.email),t(n.tx.error,"Oops!",s)):(s="".concat(r[a]),t(n.tx.error,"Oops!",s))}else e.request?t(n.tx.error,"Oops!",e.request):t(n.tx.error,"Oops!",e.message)}},4674:(e,t,s)=>{s.d(t,{Ib:()=>r,Lm:()=>n});const r=Intl.DateTimeFormat("en-ZA",{weekdays:"long",year:"numeric",month:"long",day:"numeric"}),n=Intl.DateTimeFormat("en-Za",{hour:"numeric",minute:"numeric",timeZone:"Africa/Harare",timeZoneName:"short"});Intl.NumberFormat("en-ZA",{style:"currency",currency:"zar",minimumSignificantDigits:1})},4715:(e,t,s)=>{s.d(t,{$:()=>o,ML:()=>l,Xn:()=>c});var r=s(4254),n=s.n(r),a=s(456);function o(e){const t=n()(e,"xcrossinglines");localStorage.setItem("create-job",JSON.stringify(t))}function c(){try{const e=JSON.parse(localStorage.getItem("create-job"));if(e){return[!0,(0,a.Z)(e)]}return[!1,{}]}catch(e){return[!1,{}]}}function l(){try{const e=JSON.parse(localStorage.getItem("create-job"));if(e){const t=(0,a.Z)(e);return t.vehicle_size&&t.distance&&t.helpers?[!0,t]:[!1,{}]}return[!1,{}]}catch(e){return[!1,{}]}}},8077:()=>{}}]);
//# sourceMappingURL=318.aa4fd77e.chunk.js.map