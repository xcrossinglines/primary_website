"use strict";(self.webpackChunkxcrossinglines=self.webpackChunkxcrossinglines||[]).push([[277],{5763:(e,t,s)=>{s.d(t,{_:()=>p,b:()=>f});var r=s(2791),n=s(7612),a=s(7644),o=s(3360),c=s(5794),i=s(9554),l=s(2797),d=s(6342),x=s(4921),h=s(4715),u=s(2879),m=s(5977),j=s(184);function p(){const e=r.useContext(d.IK),[t,s]=r.useState(!1),[x,p]=r.useState(!1),[f,g]=r.useState(c.tx.info),[b,y]=r.useState("Thank you!"),[w,N]=r.useState("for registering with xcrossing lines, please procceed to signin"),v=(e,t,s)=>{g((t=>e)),y((e=>t)),N((e=>s));const r=e===c.tx.loading||e===c.tx.success;p((e=>r))},Z=async t=>{v(c.tx.loading,"Signing In ...","");await i.Z.post("accounts/api/account/signin/",t).then((async t=>{if(200===t.status){v(c.tx.success,"Awesome.","Signin success");(e=>{localStorage.setItem("xcrossinglines_tokens",JSON.stringify(e))})({access:t.data.access,refresh:t.data.refresh}),await(0,m.r)((()=>e.setShow((e=>!1))),2e3);const[s,r]=(0,h.ML)();return s?void await(0,m.r)((()=>e.setShowJobNotification((e=>!0)))):void await(0,m.r)((()=>window.location.href=c.dX.home))}})).catch((e=>{(0,u.X)(e,v)}))};return(0,j.jsxs)(n.Z,{centered:!0,show:e.show,onHide:x?null:()=>{v(c.tx.none,"",""),e.setShow((e=>!1))},contentClassName:"rounded-0",children:[(0,j.jsx)(n.Z.Header,{className:"rounded-0 bg-white text-dark border-0",closeButton:!0,children:(0,j.jsx)(n.Z.Title,{style:{fontWeight:"900"},children:"Continue Signin"})}),(0,j.jsxs)(a.Z,{noValidate:!0,validated:t,onSubmit:async t=>{if(!1===t.currentTarget.checkValidity())return t.preventDefault(),t.stopPropagation(),void s(!0);t.preventDefault(),t.stopPropagation(),s(!0),await Z(e.payload)},children:[(0,j.jsxs)(n.Z.Body,{children:[(0,l.w)(f,b,w),(0,j.jsx)(a.Z.Group,{className:"mb-3",children:(0,j.jsxs)(a.Z.FloatingLabel,{label:"Email",children:[(0,j.jsx)(a.Z.Control,{className:"rounded-0 fw-bold",placeholder:"xlines@example.co.za",disabled:x,required:!0,onChange:e=>{},value:e.payload.email,type:"email"}),(0,j.jsx)(a.Z.Control.Feedback,{type:"invalid",children:"Please enter correct email address to continue"})]})}),(0,j.jsx)(a.Z.Group,{className:"my-3",children:(0,j.jsxs)(a.Z.FloatingLabel,{label:"Password",children:[(0,j.jsx)(a.Z.Control,{className:"rounded-0 fw-bold",placeholder:"Enter Password",value:e.payload.password,onChange:e=>{},disabled:x,required:!0,type:"password"}),(0,j.jsx)(a.Z.Control.Feedback,{type:"invalid",children:"Please enter correct password to continue"})]})})]}),(0,j.jsx)(n.Z.Footer,{className:"rounded-0 border-0",children:(0,j.jsx)(o.Z,{type:"submit",variant:"outline-primary",className:"rounded-0 border-0",style:{fontWeight:"800"},disabled:x,children:"Sign In"})})]})]})}function f(){const e=r.useRef(),t=r.useRef(),s=r.useContext(d.XK),[c,i]=r.useState("dark"),[l,h]=r.useState(!1);return(0,j.jsxs)(n.Z,{centered:!0,show:s.show,contentClassName:"rounded-0 border-0",children:[(0,j.jsx)(n.Z.Header,{closeButton:!0,className:"rounded-0 bg-white border-0 text-dark pb-0",onHide:()=>{h((e=>!1)),s.setShow((e=>!1)),i((e=>"dark"))},children:(0,j.jsxs)(n.Z.Title,{style:{fontWeight:"900"},children:[(0,j.jsx)("span",{className:"text-danger",children:"Google"})," Signin"]})}),(0,j.jsx)(a.Z,{noValidate:!0,validated:l,onSubmit:async r=>{const n=r.currentTarget;if(!1===n.checkValidity())return(e=>{let s=!1;const r=e.querySelectorAll(":invalid");for(let n of r)t.current.id===n.id&&(s=!0,i((e=>"danger")));s||i((e=>"success"))})(n),r.preventDefault(),r.stopPropagation(),void h(!0);r.preventDefault(),r.stopPropagation(),h(!0),s.setShow((e=>!1)),s.setCustomerPhonenumber(e.current.value),(0,m.r)((()=>{h((e=>!1)),s.setShowGoogle()}),2e3)},children:(0,j.jsxs)(n.Z.Body,{children:[(0,j.jsx)(a.Z.Group,{className:"mb-3",children:(0,j.jsxs)(a.Z.FloatingLabel,{label:"Phone number",className:"fw-bold",style:{color:"grey"},children:[(0,j.jsx)(a.Z.Control,{className:"fw-bold rounded-0",placeholder:"084 000 0000",ref:e,required:!0,maxLength:10,minLength:10,type:"tel"}),(0,j.jsx)(a.Z.Control.Feedback,{type:"invalid",children:"Please enter correct phone number to continue"}),(0,j.jsx)(a.Z.Control.Feedback,{children:"Awesome"})]})}),(0,j.jsx)(a.Z.Group,{children:(0,j.jsxs)(a.Z.Check,{required:!0,type:"checkbox",id:"terms-and-conditions",children:[(0,j.jsx)(a.Z.Check.Input,{id:"GoogleTermsAndConditions",type:"checkbox",required:!0,ref:t,onChange:e=>{l&&e.target.checked?i((e=>"success")):l&&!e.target.checked&&i((e=>"danger"))}}),(0,j.jsxs)(a.Z.Check.Label,{children:["Accept our"," ",(0,j.jsx)("a",{href:x,className:"text-".concat(c," fw-bold"),target:"_blank",rel:"noreferrer",children:"terms"})," ","and"," ",(0,j.jsx)("a",{className:"text-".concat(c," fw-bold"),href:x,target:"_blank",rel:"noreferrer",children:"conditions"})]}),(0,j.jsx)(a.Z.Control.Feedback,{type:"invalid",children:"Please accept our terms and conditions to continue with Google Sign In"})]})}),(0,j.jsx)("div",{className:"w-100 d-flex justify-content-end align-items-center my-2",children:(0,j.jsx)(o.Z,{variant:"outline-primary",className:"rounded-0 fw-bold border-0 align-end",type:"submit",children:"Proceed"})})]})})]})}},2641:(e,t,s)=>{s.d(t,{E:()=>g});var r=s(2791),n=s(7612),a=s(3360),o=s(6342),c=s(5794),i=s(2797),l=s(4715),d=s(9554),x=s(8808),h=s(9625),u=s(2879),m=s(5977),j=s(6355),p=s(4674),f=s(184);function g(){const e=r.useContext(o.kH),t=r.useRef(),[s,g]=r.useState(!1),[b,y]=r.useState({}),[w,N]=r.useState({mid_discount:0,referal_discount:0,base_fee:0,amount_due:0}),[v,Z]=r.useState(!1),[k,C]=r.useState(c.tx.warning),[S,_]=r.useState(""),[P,q]=r.useState(""),I=(e,t,s)=>{C((t=>e)),_((e=>t)),q((e=>s));const r=e===c.tx.loading||e===c.tx.success;g((e=>r))},F=r.useCallback((async()=>{const[e,t]=(0,l.Xn)();if(e){y((()=>t)),Z((e=>!1)),I(c.tx.loading,"Loading ...","");const e="jobs/api/job/generate-quote/";await d.Z.post(e,t).then((e=>{200===e.status&&(Z((e=>!0)),N((t=>e.data)),I(c.tx.warning,"Dear valued customer. ","We have detected an existing job that's uncomplete, click the BOOK button to complete."))})).catch((e=>{Z((e=>!0)),(0,u.X)(e,I)}))}}),[]),A=e=>{let{leading:t,trailing:s}=e;return(0,f.jsxs)("div",{className:"d-flex flex-row justify-content-start align-items-center",children:[(0,f.jsxs)("span",{className:"fw-bold text-dark me-2",children:[t,":"]}),(0,f.jsx)("span",{className:"fw-normal text-dark",children:s})]})},D=e=>{let{leading:t,trailing:s}=e;return(0,f.jsxs)("div",{className:"d-flex flex-column justify-content-start align-items-start",children:[(0,f.jsxs)("span",{className:"text-dark fw-bold me-2",children:[t,":"]}),(0,f.jsx)("span",{className:"fw-normal text-dark",children:s})]})};return r.useEffect((()=>{e.show&&F()}),[F,e.show]),(0,f.jsxs)(n.Z,{centered:!0,show:e.show,contentClassName:"rounded-0",onHide:s?null:async()=>{I(c.tx.none,"",""),e.setShow((e=>!1)),await(0,m.r)((()=>window.location.href=c.dX.home),2e3)},children:[(0,f.jsx)(n.Z.Header,{ref:t,closeButton:!0,className:"rounded-0 bg-white text-dark pb-0 border-0",children:(0,f.jsx)(n.Z.Title,{style:{fontWeight:"900"},children:"Job notification"})}),(0,f.jsxs)(n.Z.Body,{className:"px-0",children:[(0,f.jsx)("div",{className:"mb-3 px-3",children:(0,i.w)(k,S,P)}),((e,t,s)=>{if(e)return(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{className:"d-flex flex-column px-3 mb-3",children:[(0,f.jsx)(A,{leading:"Job date",trailing:"".concat(p.Ib.format(new Date(t.job_date)))}),(0,f.jsx)(A,{leading:"Job time",trailing:"".concat(p.Lm.format(new Date("".concat(t.job_date," ").concat(t.job_time," "))))}),(0,f.jsx)(A,{leading:"Payment option",trailing:"".concat("".concat(t.payment_option).toUpperCase().charAt(0)+"".concat(t.payment_option).slice(1).toLowerCase())}),(0,f.jsx)(D,{leading:"Driver Note",trailing:"".concat(t.driver_note)})]}),(0,f.jsx)("div",{className:"px-3",children:(0,f.jsxs)("table",{className:"table table-success table-striped table-bordered",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{scope:"col",children:"Description"}),(0,f.jsx)("th",{scope:"col",children:"Qty"})]})}),(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:"Distance"}),(0,f.jsx)("td",{children:"".concat(t.distance," km")})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:"Vehicle size"}),(0,f.jsx)("td",{children:"".concat(t.vehicle_size," ton")})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:"Helpers"}),(0,f.jsx)("td",{children:"".concat(t.helpers)})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:"Floors"}),(0,f.jsx)("td",{children:"".concat(t.floors)})]})]})]})}),(0,f.jsx)("div",{className:"mt-2",children:(0,f.jsx)(x.U,{job:s})})]})})(v,b,w)]}),(0,f.jsx)(n.Z.Footer,{className:"bg-white border-0",children:(0,f.jsxs)(a.Z,{variant:"outline-primary",className:"rounded-0 border-0 fw-bold d-flex flex-row justify-content-center align-items-center gap-2",disabled:s,onClick:()=>(async t=>{const[s,r]=(0,h.f)();if(s){I(c.tx.loading,"Creating Job ...","");const s={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.access)}},n="jobs/api/job/create/";return void await d.Z.post(n,t,s).then((async t=>{if(200===t.status){const t="Job successfully created";return I(c.tx.success,"Awesome. ",t),localStorage.removeItem("create-job"),await(0,m.r)((()=>e.setShow((e=>!1))),2e3),void await(0,m.r)((()=>window.location.href=c.dX.jobs))}})).catch((e=>{(0,u.X)(e,I)}))}g((e=>!0)),I(c.tx.info,"Dear valued customer. ","".concat("to complete your Job kindly please sign-in, a popup will show to confirm your job.")),await(0,m.r)((()=>window.location.href=c.dX.signin),3e3)})(b),children:["Book",(0,f.jsx)(j.l_A,{})]})})]})}},6746:(e,t,s)=>{s.d(t,{i:()=>n});s(2791);var r=s(184);function n(){return(0,r.jsx)("hr",{className:"p-0 my-2 border-0",color:"#c9c9c9",style:{height:"2px",width:"100%"}})}},8808:(e,t,s)=>{s.d(t,{U:()=>d});s(2791);var r=s(9813),n=s(2144),a=s(8396),o=s(9126),c=s(5794),i=s(6612),l=s(184);function d(e){let{job:t,padding:s="p-3"}=e;const d=Intl.NumberFormat("en-ZA",{style:"currency",currency:"zar",minimumSignificantDigits:1}),x=e=>(0,l.jsx)(r.Z,{id:"popover-basic",className:"rounded-0 border-secondary",arrowProps:{style:{backgroundColor:"red"}},children:(0,l.jsx)(r.Z.Body,{className:"text-secondary fw-bold rounded-0",children:e})});return(0,l.jsx)(n.Z,{className:"dropdown__shadow rounded-0 border-0",children:(0,l.jsx)(n.Z.Body,{className:"".concat(s),children:(0,l.jsxs)("table",{className:"table table-bordered table-striped table-dark m-0",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",children:"Description"}),(0,l.jsx)("th",{scope:"col",children:"Price(ZAR)"})]})}),(0,l.jsxs)("tbody",{children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"d-flex flex-row",children:[(0,l.jsx)("span",{children:"Base fee"}),(0,l.jsx)(i.w,{className:"px-1",children:(0,l.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.rF)),children:(0,l.jsx)("div",{children:(0,l.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,l.jsx)("td",{children:"".concat(d.format(t.base_fee))})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"d-flex flex-row",children:[(0,l.jsx)("span",{children:"Off peak"}),(0,l.jsx)(i.w,{className:"px-1",children:(0,l.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.Pm)),children:(0,l.jsx)("div",{children:(0,l.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,l.jsx)("td",{className:"text-danger fw-bolder",children:"".concat(t.mid_discount>0?"-":""," ").concat(d.format(t.mid_discount))})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"d-flex flex-row",children:[(0,l.jsx)("span",{children:"Return customer"}),(0,l.jsx)(i.w,{className:"px-1",children:(0,l.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.te)),children:(0,l.jsx)("div",{children:(0,l.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,l.jsx)("td",{className:"text-danger fw-bolder",children:"".concat(t.return_customer_discount>0?"-":""," ").concat(d.format(t.return_customer_discount))})]}),t.give_extra_discount?(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"d-flex flex-row",children:[(0,l.jsx)("span",{children:"Extra discount"}),(0,l.jsx)(i.w,{className:"px-1",children:(0,l.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.j_)),children:(0,l.jsx)("div",{children:(0,l.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,l.jsx)("td",{className:"text-danger",children:"".concat(t.give_extra_discount?"-":""," ").concat(d.format(t.extra_discount))})]}):null,t.set_price_adjustment?(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"d-flex flex-column",children:[(0,l.jsxs)("div",{className:"d-flex flex-row",children:[(0,l.jsx)("span",{children:"Price adjustment"}),(0,l.jsx)(i.w,{className:"px-1",children:(0,l.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.fk)),children:(0,l.jsx)("div",{children:(0,l.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]}),(0,l.jsxs)("span",{className:"text-muted form-text fw-bold border border-2 px-1 bg-light",children:["Price adjustment justification:"," ",(0,l.jsx)("span",{className:"text-dark",children:t.price_adjustment_justification})]})]})}),(0,l.jsx)("td",{children:"".concat(d.format(t.price_adjustment))})]}):null]}),(0,l.jsx)("tfoot",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"d-flex flex-row",children:[(0,l.jsx)("span",{style:{fontWeight:"900"},children:"Amount due"}),(0,l.jsx)(i.w,{className:"px-1",children:(0,l.jsx)(a.Z,{trigger:"click",placement:"top",rootClose:!0,overlay:x("".concat(c.Iu)),children:(0,l.jsx)("div",{children:(0,l.jsx)(o.Hfo,{role:"button",className:"text-primary"})})})})]})}),(0,l.jsx)("td",{children:(0,l.jsx)("span",{style:{fontWeight:"900",fontSize:"".concat(1.25,"rem")},children:d.format(t.amount_due).replace("ZA","")})})]})})]})})})}},6342:(e,t,s)=>{s.d(t,{IK:()=>n,Vz:()=>i,XK:()=>a,eJ:()=>c,j3:()=>o,kH:()=>l});var r=s(2791);const n=r.createContext(),a=r.createContext(),o=r.createContext(),c=r.createContext(),i=r.createContext(),l=r.createContext()},2879:(e,t,s)=>{s.d(t,{X:()=>a});const r={100:"Continue",101:"Switching protocols",102:"Processing",103:"Early hints",200:"Ok",201:"Created",202:"Accepted",203:"Non authoritative information",204:"No content",205:"Reset content",206:"Partial content",207:"Multi status",208:"Already reported",226:"Im used",300:"Multiple choices",301:"Moved permanently",302:"Found",303:"See other",304:"Not modified",305:"Use proxy",306:"Reserved",307:"Temporary redirect",308:"Permanent redirect",400:"Bad request",401:"Unauthorized",402:"Payment required",403:"Forbidden",404:"Not found",405:"Method_not_allowed",406:"Not acceptable",407:"Proxy authentication required",408:"Request timeout",409:"Conflict",410:"Gone",411:"Length required",412:"Precondition failed",413:"Request entity too large",414:"Request uri too long",415:"Unsupported media type",416:"Requested range not satisfiable",417:"Expectation failed",418:"Im a teapot",421:"Misdirected_request",422:"Unprocessable entity",423:"Locked",424:"Failed dependency",425:"Too early",426:"Upgrade required",428:"Precondition required",429:"Too many requests",431:"Request header fields too large",451:"Unavailable for legal reasons"};var n=s(5794);function a(e,t){if(e.response){let s;const a=e.response.status;if(a>=500)return s="Internal server error. Contact admin",void t(n.tx.error,"Oops!",s);e.response.data.detail?(s="".concat(r[a],", ").concat(e.response.data.detail),t(n.tx.error,"Oops!",s)):e.response.data.msg?(s="".concat(r[a],", ").concat(e.response.data.msg),t(n.tx.error,"Oops!",s)):e.response.data.email?(s="".concat(r[a],", ").concat(e.response.data.email),t(n.tx.error,"Oops!",s)):(s="".concat(r[a]),t(n.tx.error,"Oops!",s))}else e.request?t(n.tx.error,"Oops!",e.request):t(n.tx.error,"Oops!",e.message)}},4674:(e,t,s)=>{s.d(t,{Ib:()=>r,Lm:()=>n});const r=Intl.DateTimeFormat("en-ZA",{weekdays:"long",year:"numeric",month:"long",day:"numeric"}),n=Intl.DateTimeFormat("en-Za",{hour:"numeric",minute:"numeric",timeZone:"Africa/Harare",timeZoneName:"short"});Intl.NumberFormat("en-ZA",{style:"currency",currency:"zar",minimumSignificantDigits:1})},4715:(e,t,s)=>{s.d(t,{$:()=>o,ML:()=>i,Xn:()=>c});var r=s(4254),n=s.n(r),a=s(456);function o(e){const t=n()(e,"xcrossinglines");localStorage.setItem("create-job",JSON.stringify(t))}function c(){try{const e=JSON.parse(localStorage.getItem("create-job"));if(e){return[!0,(0,a.Z)(e)]}return[!1,{}]}catch(e){return[!1,{}]}}function i(){try{const e=JSON.parse(localStorage.getItem("create-job"));if(e){const t=(0,a.Z)(e);return t.vehicle_size&&t.distance&&t.helpers?[!0,t]:[!1,{}]}return[!1,{}]}catch(e){return[!1,{}]}}}}]);
//# sourceMappingURL=277.00df1cd1.chunk.js.map